name: PR Chack if Image is set in config

on:
    pull_request:
        types: [ synchronize, opened ]
    workflow_dispatch:

jobs:
  updateBody:
    runs-on: ubuntu-latest
    steps:
        - uses: actions/checkout@v4
          with:
                submodules: true

        - name: Extract branch name
          shell: bash
          run: echo "BR_VERSION=${GITHUB_REF##*/}" >> "$GITHUB_OUTPUT"
          id: extract_branch                

        - name: ðŸ‘“ read-yaml-file ${{ steps.extract_branch.outputs.BR_VERSION }}/config.yaml
          uses: pietrobolcato/action-read-yaml@1.1.0
          id: read_action_js
          with:
            config: ${{ github.workspace }}/${{ steps.extract_branch.outputs.BR_VERSION }}/config.yaml    

        - name: Check image in yaml config of ${{ steps.extract_branch.outputs.BR_VERSION }}
          if: ${{ steps.read_action_js.outputs.image == '' }}
          uses: actions/github-script@f28e40c7f34bde8b3046d885e986cb6290c5673b # v7.1.0
          with:
            script: |
                core.setFailed('Image in yaml config of ${{ steps.extract_branch.outputs.BR_VERSION }} is not set!')